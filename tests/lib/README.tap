tap.c and tap.h were taken from
http://jc.ngo.org.uk/trac-bin/trac.cgi/wiki/LibTap
